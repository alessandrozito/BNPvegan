---
title: "An introduction to BNPvegan"
author: "Alessandro Zito"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: rmdformats::readthedown
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

```{r, warning=FALSE}
library(BNPvegan)
```


# Species Sampling model




# Species Discovery model

Species discovery models focus directly on the discovery of new species. Thus, they are *not* a generative model for a species distribution. Their fundamental goal is to fit and predict any accumulation curve, potentially assessing its degree of convergence. 

Their formulation is is the following. Let $(D_n)_{n \geq 1}$ be a sequence of *discovery indicators*, such that 

$$
D_n = \begin{cases}
1 & \text{if} \quad  X_n = ``\text{new}"\\
0 & \text{if} \quad  X_n = ``\text{observed}"
\end{cases}
$$

and trivially $D_n = 1$. 



```{r, cache = TRUE}
# Compute the sample-based rarefaction curve (i.e. the average accumulation curve)
freq <- fungalOTU
rar <- rarefaction(freq)
```


```{r}
rarefaction(fungalOTU)

out = ssm(fungalOTU, model = "PY")
predict(out)
```



